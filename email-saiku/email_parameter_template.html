<html xmlns:xf="http://www.w3.org/2002/xforms">
   <head>
	<!-- do not include a <meta> tag -->
      <link rel="stylesheet" type="text/css" href="/pentaho-style/pentaho.css"></link>
      <title>Email a Saiku Adhoc Report</title>

						<script src="js/parameters.js" type="text/javascript"></script>

      			<script><![CDATA[
      			  var url=unescape('ViewAction?');
      			  var target=unescape('');
      			  function doForm() {
      			    var submitUrl = url;
      			    var form = document.forms['parameter-form'];
      			    var elements = form.elements;
      			    var i;
      			    for( i=0; i<elements.length; i++ ) {
      			      if( elements[i].type == 'select-one' || elements[i].type == 'text' || elements[i].type == 'textarea' || elements[i].type == 'hidden') {
      			        submitUrl += '&' + elements[ i ].name + '=' + escape( elements[ i ].value );
      			      } else if( elements[i].type == 'radio' ) {
      			      	if( elements[i].checked ) {
      			          submitUrl += '&' + elements[ i ].name + '=' + escape( elements[ i ].value );
      			      	}
      			      } else if( elements[i].type == 'checkbox' ) {
      			      	if( elements[i].checked ) {
      				      submitUrl += '&' + elements[i].name + "=" + escape( elements[i].value );
      			      	}
      			      } else if( elements[i].type == 'select-multiple' ) {
      				    var options = elements[i].options;
      				    var j;
      				    for( j=0; j!=options.length; j++ ) {
      				      if( options[j].selected ) {
      	  			        submitUrl += '&' + elements[i].name + '=' + escape( options[ j ].value );
      				      }
      				    }
      				  }
      			    }
      			    if( target == '' ) {
      				    document.location.href=submitUrl;
      				} else {
      					window.open( submitUrl, target );
      				}
      			    return false;
      			  }
      			]]></script>

	{xform-header}

   </head>
   <body style="border:2px solid #dddddd">
      <div style="margin:10px"><span class="portlet-section-header">Email a Saiku Adhoc Report</span></div>
      <div style="margin:10px;border:1px solid #808080;padding:5px;">
         <form name="parameter-form" id="parameter-form" method="GET">
         <fieldset>
         <legend>Submit Saiku Report to Email</legend>
            <table width="100%" style="padding:5px;">
               <tr>
                  <td><span class="portlet-font">Please enter the details of the Saiku Adhoc query report that you wish to email:</span></td>
               </tr>
               <tr>
                  <td class="portlet-section-subheader"><p/>Select a report output type
                  </td>
               </tr>
               <tr>
                  <label for="ReportType">Report Output Type</label>
                  <td class="portlet-font">{ReportType}</td>
               </tr>
               <tr>
                  <td class="portlet-section-subheader"><p/>Solution directory path containing saved report:</td>
               </tr>
               <tr>
                  <label for="saiku-solution">Saiku Solution Path (directory)</label>
                  <td class="portlet-font">{saiku-solution}</td>
               </tr>
               <tr>
                  <td class="portlet-section-subheader"><p/>Saved Saiku Adhoc report file name (add extension .adhoc or .saiku)</td>
               </tr>
               <tr>
                  <label for="saiku-query">Saiku Saved Query</label>
                  <td class="portlet-font">{saiku-query}</td>
               </tr>
                  <tr>
                  <td class="portlet-section-subheader"><p/>To address eg: someone@example.com</td>
               </tr>
               <tr>
                  <label for="to">To Address</label>
                  <td class="portlet-font"><input id="to" class="portlet-form-field" type="text" size="50" name="to" autocomplete="on" title="Email To address"/></td>
               </tr>
                  <tr>
                  <td class="portlet-section-subheader"><p/>From address</td>
               </tr>
               <tr>
                  <label for="from">From Address</label>
                  <td class="portlet-font"><input id="from" class="portlet-form-field" type="text" size="50" name="from" value="noreply@example.com" title="Email From address"/></td>
               </tr>
                  <tr>
                  <td class="portlet-section-subheader"><p/>Subject</td>
               </tr>
               <tr>
                  <label for="subject">Subject</label>
                  <td class="portlet-font"><input id="subject" class="portlet-form-field" type="text" size="75" name="subject" value="Open Training report from Pentaho" title="Email subject line"/></td>
               </tr>
                  <tr>
                  <td class="portlet-section-subheader"><p/>Covering message</td>
               </tr>
               <tr>
                  <label for="message-plain">Covering Message</label>
                  <td class="portlet-font"><TEXTAREA id="message-plain" class="portlet-form-field" name="message-plain" COLS="75" ROWS="6"></TEXTAREA></td>
               </tr>
               <tr>
                  <td><br/><input type="button" name="go" class="portlet-form-button" value="Run..." onClick="doForm()"/></td>
               </tr>
            </table>
		{solution}
		{action}
		{path}
      </fieldset>
	    </form>
      </div>
   </body>
</html>